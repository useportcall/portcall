<!DOCTYPE html>
<html>
  <head>
    <title>View invoice</title>
    <style>
      @property --tw-border-style {
        syntax: "*";
        inherits: false;
        initial-value: solid;
      }

      #download-btn {
        position: fixed;
        top: 24px;
        right: 24px;
        z-index: 1000;
        background: rgb(255, 255, 255);
        color: rgb(10, 10, 10);
        border-width: 1px;
        border-radius: calc(0.5rem - 2px);
        border-color: hsl(0 0% 89.8%);
        font-family: ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji",
          "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
        font-size: 0.875rem;
        line-height: calc(1.25 / 0.875);
        height: calc(0.25rem * 8);
        padding: 0.25rem 0.5rem;
        padding-inline: calc(0.25rem * 2.5);
        transition-property: all;
        --tw-shadow: 0 1px 2px 0 var(--tw-shadow-color, #0000000d);
        box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow),
          var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);
        white-space: nowrap;
        border-style: var(--tw-border-style);
      }

      #download-btn:hover {
        background-color: hsl(0 0% 96.1%);
      }
      #iframe-container {
        display: flex;
        justify-content: center;
        align-items: flex-start;
        width: 100vw;
        height: 100vh;
      }
      #invoice-frame {
        width: 100vw;
        height: 100vh;
        border: none;
        background: #fff;
        box-shadow: 0 2px 16px rgba(0, 0, 0, 0.08);
      }
      #loading-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(255, 255, 255, 0.85);
        z-index: 2000;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        color: #333;
      }
      .spinner {
        border: 6px solid #f3f3f3;
        border-top: 6px solid #007bff;
        border-radius: 50%;
        width: 48px;
        height: 48px;
        animation: spin 1s linear infinite;
        margin-bottom: 18px;
      }
      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }
    </style>
  </head>
  <body style="margin: 0; padding: 0">
    <div id="loading-overlay">
      <div class="spinner"></div>
      <div id="loading-text">Loading invoiceâ€¦</div>
    </div>
    <button id="download-btn" onclick="printInvoice()">Download PDF</button>
    <div id="iframe-container">
      <iframe id="invoice-frame" src="{{.Src}}" allowfullscreen></iframe>
    </div>
    <script>
      function printInvoice() {
        const iframe = document.getElementById("invoice-frame");
        if (iframe && iframe.contentWindow) {
          iframe.contentWindow.focus();
          iframe.contentWindow.print();
        } else {
          alert("Invoice not loaded yet.");
        }
      }
      const overlay = document.getElementById("loading-overlay");
      const iframe = document.getElementById("invoice-frame");
      iframe.onload = function () {
        overlay.style.display = "none";
      };
    </script>
  </body>
</html>
